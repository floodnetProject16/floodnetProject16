<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Martin Durocher" />

<meta name="date" content="2020-01-14" />

<title>FloodNet Project 1.6</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">FloodNet Project 1.6</h1>
<h4 class="author">Martin Durocher</h4>
<h4 class="date">2020-01-14</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>One objective of <a href="http://www.nsercfloodnet.ca/">FloodNet</a> Project 1.6 is to provide Canadian engineers and hydrologists with a toolbox that can help them to perform flood frequency analysis. To this end, a set of functions was developed and added to the R-package <a href="https://github.com/floodnetProject16/CSHShydRology">CSHShydRology</a>. The package provides advanced users with a variety of functions to perform flood frequency analysis. Another tool available to the hydrologist community is the R-package <a href="https://github.com/CentreForHydrology/HYDAT">HYDAT</a> that allows R to communicate with the <a href="https://www.canada.ca/en/environment-climate-change/services/water-overview/quantity/monitoring/survey/data-products-services/national-archive-hydat.html">National Water Data Archive</a> maintained by the <a href="https://www.canada.ca/en/environment-climate-change/services/water-overview/quantity/monitoring/survey.html">Water Survey of Canada</a>. This database can be downloaded and used to extract the necessary hydrological information. The goal of the R-package <code>FloodnetProject16</code> is to provide simple routines that extract directly the data from HYDAT and carry out flood frequency analysis according to FloodNet recommendations.</p>
</div>
<div id="flood-frequency-analysis-using-annual-maxima" class="section level2">
<h2>Flood frequency analysis using annual maxima</h2>
<p>The functionality of the R-package will be illustrated on the station ‘01AF009’ that is located on the Iroquois River (NB). In general, a flood frequency analysis consists of fitting a distribution for extreme events and evaluating the risk of occurrence for events of specific magnitudes. Such risk is commonly quantified in terms of a return period <span class="math inline">\(T\)</span> defined as the expected waiting time between the extreme events. If flood risk does not change over time, <em>i.e.</em> a stationary time series, evaluating a return period is equivalent to evaluating the quantiles of the distribution associated with the probability <span class="math inline">\(1-1/T\)</span>. The example below extracts the annual maxima of the station ‘01AF009’ from HYDAT and output the results of the flood frequency analysis in the form of a table.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(floodnetProject16)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(CSHShydRology)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">## Station of interest and path of the HYDAT database</span></a>
<a class="sourceLine" id="cb1-5" title="5">mystation &lt;-<span class="st"> &#39;01AF009&#39;</span></a>
<a class="sourceLine" id="cb1-6" title="6">db &lt;-<span class="st"> </span>DB_HYDAT</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">FloodnetAmax</span>(<span class="dt">site =</span> mystation, <span class="dt">db =</span> db, <span class="dt">period =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">##      site method distribution period variable      value</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">## 1 01AF009   amax          gev     10 quantile  59.103900</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">## 2 01AF009   amax          gev    100 quantile  98.047204</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">## 3 01AF009   amax          gev     10       se   6.295034</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">## 4 01AF009   amax          gev    100       se  26.752092</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">## 5 01AF009   amax          gev     10    lower  47.671137</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">## 6 01AF009   amax          gev    100    lower  61.147203</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">## 7 01AF009   amax          gev     10    upper  72.275943</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">## 8 01AF009   amax          gev    100    upper 162.740380</span></a></code></pre></div>
<p>More precisely, it fits the distribution using L-moments and evaluates its uncertainty using a parametric bootstrap technique. If not specified, the best distribution among the Generalized Extreme Value (GEV), Generalized Logistic (GLO), Generalized Normal (GNO) and Pearson type III (PE3) is selected based on the Akaike Information Criterion (AIC). The distribution with the lowest AIC is compared to the GEV. If the difference between the two criteria lower than two, they assumed to fit the data equally well and the GEV is preferred. Otherwise, the distribution with the lowest AIC is selected.</p>
<p>To use data from alternative sources, the argument <code>db</code> must be replaced by <code>x</code>. In that case, the argument <code>site</code> is optional and may be used to specify a station name. In the example below the function <code>AmaxData</code> is used to extract the Annual maxima of the station <code>01AF009</code> from HYDAT and pass to <code>FloodnetAmax</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">an &lt;-<span class="st"> </span><span class="kw">AmaxData</span>(<span class="st">&#39;01AF009&#39;</span>, db)</a>
<a class="sourceLine" id="cb3-4" title="4">out &lt;-<span class="st"> </span><span class="kw">FloodnetAmax</span>(<span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">x =</span> an<span class="op">$</span>value, <span class="dt">out.model =</span> <span class="ot">TRUE</span>, <span class="dt">nsim =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">names</span>(out)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">## [1] &quot;fit&quot; &quot;qua&quot;</span></a></code></pre></div>
<p>The function <code>FloodnetAmax</code> is built on top of the function <code>FitAmax</code> of the R-package <code>CSHShydRology</code>. If the argument <code>out.model = TRUE</code> the output of <code>FitAmax</code> is returned. The example below shows that a return level plot can be easily obtained from the output model.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">plot</span>(out<span class="op">$</span>fit, <span class="dt">ci =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>By default the argument <code>verbose = TRUE</code>, which will perform further verifications to warn the user if there are fewer than 20 observations or if it detects trend or a change points according to the Mann-Kendall and Pettitt test (Helsel and Hirsch, 2002).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">## Create a change point to existing data</span></a>
<a class="sourceLine" id="cb5-2" title="2">an.mod &lt;-<span class="st"> </span>an<span class="op">$</span>value <span class="op">+</span><span class="st"> </span><span class="dv">50</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(an) <span class="op">&gt;</span><span class="st"> </span><span class="dv">14</span>) </a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-5" title="5">out &lt;-<span class="st"> </span><span class="kw">FloodnetAmax</span>(<span class="dt">x =</span> an.mod, <span class="dt">period =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">## Warning in FloodnetAmax(x = an.mod, period = 100): </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">## There may be a trend in the data.</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">## Warning in FloodnetAmax(x = an.mod, period = 100): </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">## There may be a change point in the data.</span></a></code></pre></div>
</div>
<div id="flood-frequency-analysis-using-peaks-over-threshold" class="section level2">
<h2>Flood frequency analysis using peaks over threshold</h2>
<p>An alternative to the analysis of annual maxima (AMAX) is Peak Over Threshold (POT). For this approach, all exceedances above a given threshold are analyzed. As shown below, flood quantiles from POT can be obtained using the function <code>floodnetPot</code> that is built upon the function <code>FitPot</code> of the R-package <code>CSHShdRology</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">FloodnetPot</span>(<span class="dt">site =</span> mystation, <span class="dt">db =</span> db, <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">u =</span> <span class="dv">20</span>, <span class="dt">area =</span> <span class="fl">184.1</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">##      site method distribution period variable     value</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">## 1 01AF009    pot          gpa    100 quantile  91.48292</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">## 2 01AF009    pot          gpa    100       se  20.13597</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">## 3 01AF009    pot          gpa    100    lower  58.69652</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">## 4 01AF009    pot          gpa    100    upper 136.36445</span></a></code></pre></div>
<p>The POT method requires a threshold <code>u</code> above which independent exceedances are extracted. Here, the drainage area is needed to determine a minimal separating time between independent peaks as suggested by the US Water Resources Council (USWRC) (lang et al., 1999). For the station <code>01AF009</code>, the drainage area is 184.1 <span class="math inline">\(km^2\)</span> and <span class="math inline">\(u = 20\)</span> was found to be a proper threshold leading roughly to an average of 2.07 peaks per year (PPY). The Generalized Pareto (GPA) distribution is used to model the distribution of the exceedances. The T-year flood quantiles of a POT model is defined as the flood quantiles of probability <span class="math inline">\(1 - (\lambda T)^{-1}\)</span> of the exceedance distribution, where <span class="math inline">\(\lambda\)</span> is the average number of peaks per year.</p>
<p>If the user wants to use data from another source, this must be passed as a data.frame where the first column is a date (<em>i.e.</em> class <code>Date</code>) and the second column is daily observations. The function <code>DailyData</code> can be used to extract these hydrometric data in the proper format.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3">daily &lt;-<span class="st"> </span><span class="kw">DailyData</span>(mystation, db)[,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="kw">FloodnetPot</span>(<span class="dt">x =</span> daily, <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">u =</span> <span class="dv">20</span>, <span class="dt">area =</span> <span class="fl">184.1</span>, <span class="dt">nsim =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">##   site method distribution period variable    value</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">## 1 site    pot          gpa    100 quantile 91.48292</span></a></code></pre></div>
<p>Generally, the POT analysis is based on more data than AMAX, which is likely to reduce the uncertainty of the estimated flood quantiles. In this example, the standard deviation of the 100-year flood quantile of the POT model is 20.1 and was 26.8 for AMAX.</p>
<p>During the FloodNet project, 1114 stations of HYDAT were identified as having a natural flow regime and at least 20 years of observations. The table <code>gaugedSites</code> of the present package contains some information collected during the project about these stations. It includes among other some candidate thresholds. One of these thresholds (column <code>auto</code>) is obtained automatically based on the p-value of the goodness-of-fit test of Anderson-Darting (Durocher et al. 2019). The other thresholds are associated with specific PPY. For instance, the column <code>ppy175</code> is a threshold associated with approximately 1.75 PPY. It must be pointed out that these thresholds were derived from data downloaded in August 2019. The automatic threshold found for <code>01AF009</code> is 15.9, which is lower than the one previously used.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">gaugedSites[<span class="dv">5</span>, <span class="kw">c</span>(<span class="st">&#39;station&#39;</span>,<span class="st">&#39;description&#39;</span>, <span class="st">&#39;area&#39;</span>,<span class="st">&#39;auto&#39;</span>,<span class="st">&#39;ppy250&#39;</span>)]</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">##   station                        description     area auto ppy250</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">## 5 01AF009 IROQUOIS RIVER AT MOULIN MORNEAULT 184.1086 15.9   15.9</span></a></code></pre></div>
<p>If a threshold is not provided to the function <code>FloodnetPot</code>, it will be sought by the automatic method. On rare occasions where the drainage area (<span class="math inline">\(A\)</span>) would also be unknown, it will be approximated by its empirical relationship with the mean daily flow (<span class="math inline">\(M\)</span>).</p>
<p><span class="math display">\[
\log(A) = 4.0934 + 0.9944 \, \log(M)
\]</span> The exemple below shows that the result of the POT analysis where the threshold was selected automatically. The return level plot and the p-value of the goodness-of-fit test of Anderson-Darling suggest that GPA is a proper model for the exceedance.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">out &lt;-<span class="st"> </span><span class="kw">FloodnetPot</span>(<span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">site =</span> mystation, <span class="dt">db =</span> db, </a>
<a class="sourceLine" id="cb9-3" title="3">                                     <span class="dt">area =</span> <span class="fl">184.1</span>, <span class="dt">out.model =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">## [Searching for a threshold]</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">## =========</span></a>
<a class="sourceLine" id="cb9-7" title="7"></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw">GofTest</span>(out<span class="op">$</span>fit, <span class="dt">method =</span> <span class="st">&#39;ad&#39;</span>)</a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">## Goodness-of-fit test</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">##  </span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">## Test = Anderson-Darling </span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">## Distribution = gpa</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">## statistic : 0.4842 </span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">## p-value : 0.362</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>When <code>out.model = TRUE</code> and the threshold was selected automatically, the output will include additional information to validate the choice of the threshold. The graphics below represent common diagnostics. For a well-chosen threshold, the Mean Residual Life plot should be approximately linear, which seems to be the case after <code>u=20</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">uval &lt;-<span class="st"> </span>out<span class="op">$</span>u[out<span class="op">$</span>u[,<span class="st">&quot;ppy&quot;</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.2</span>,]</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4">Fplot &lt;-<span class="st"> </span><span class="cf">function</span>(vname, mainLab, ylab){ </a>
<a class="sourceLine" id="cb10-5" title="5">  <span class="kw">plot</span>(uval[,<span class="st">&#39;u&#39;</span>], uval[, vname], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> mainLab ,</a>
<a class="sourceLine" id="cb10-6" title="6">       <span class="dt">xlab =</span> <span class="st">&#39;Threshold&#39;</span>, <span class="dt">ylab =</span> ylab)</a>
<a class="sourceLine" id="cb10-7" title="7">  <span class="kw">abline</span>(<span class="dt">v =</span> <span class="fl">15.9</span>, <span class="dt">col =</span> <span class="dv">6</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-9" title="9">}</a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">Fplot</span>(<span class="st">&#39;mrl&#39;</span>, <span class="st">&#39;Mean Residual Life&#39;</span>, <span class="st">&#39;MRL&#39;</span>)</a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">2</span>), <span class="dt">lty =</span> <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">2</span>), </a>
<a class="sourceLine" id="cb10-13" title="13">             <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;auto&#39;</span>,<span class="st">&#39;manual&#39;</span>))</a>
<a class="sourceLine" id="cb10-14" title="14"><span class="kw">Fplot</span>(<span class="st">&#39;ad&#39;</span>, <span class="st">&#39;Anderson-Darling&#39;</span>, <span class="st">&#39;p-value&#39;</span>)</a>
<a class="sourceLine" id="cb10-15" title="15"><span class="kw">Fplot</span>(<span class="st">&#39;kap&#39;</span>, <span class="st">&#39;Shape parameter&#39;</span>, <span class="st">&#39;Kappa&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="regional-flood-frequency-analysis-using-amax" class="section level2">
<h2>Regional flood frequency analysis using AMAX</h2>
<p>The quality of the flood quantile estimates for longer return periods depends heavily on the tail of the distribution. For common distributions employed in flood frequency analysis, this is controlled by a shape parameter. When there are only a few years of data for the site of interest, the variability of the estimates may be large. To reduce it, Regional Frequency Analysis (RFA) was suggested to transfer information to the target site from a group of stations that has similar characteristics.</p>
<p>The strategy recommended by FloodNet consists of using pooling groups corresponding to the nearest sites of the target, where the delineation is based on a similarity measure that accounts for the regularity and timing of the annual flood peaks (Mostofi Zadeh and Burn, 2019). These stations can be taken from all available stations or from a larger group, called here super regions, that share common characteristics that are not part of the similarity measure. The dataset <code>gaugedsites</code> contains pre-delineated super regions based on clustering techniques that have identified meaningful clusters of stations. Both the hierarchical and k-means clustering methods are considered and use the same 4 variables: drainage area, mean annual precipitation (MAP), longitude and latitude. In the following, the presentation of RFA method is done using the super regions of station ‘01AF009’ proposed in column <code>supreg_km12</code> of the dataset <code>gaugedsites</code>, which used the k-means clustering method. The figure below displays the 12 resulting super regions in both the descriptor and the geographical space.</p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Another information provided by <code>gaugedSites</code> is the p-values of common trend tests. This can be used to remove stations presenting signs of nonstationary, <em>i.e.</em> stations where flood risk is changing over time. For AMAX data, it includes the result of the nonparametric test of Mann-Kendall (<code>trend_mk</code>) and the Pettitt’s test (<code>trend_pt</code>). Overall, the information in <code>gaugedSites</code> is useful to select a super region for <code>01AF009</code> where only stationary stations are included. In this case, the super region includes 107 stations, among which 100 are stationary.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">## Filter nonstationary sites from the super region of the target</span></a>
<a class="sourceLine" id="cb11-2" title="2">target.supreg &lt;-<span class="st"> </span><span class="kw">with</span>(gaugedSites, supreg_km12[station <span class="op">==</span><span class="st"> </span>mystation])</a>
<a class="sourceLine" id="cb11-3" title="3">cond_supreg &lt;-<span class="st"> </span><span class="kw">with</span>(gaugedSites, supreg_km12 <span class="op">==</span><span class="st"> </span>target.supreg)</a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5">pval.mk &lt;-<span class="st"> </span>gaugedSites<span class="op">$</span>trend_mk <span class="co">## Mann-Kendall</span></a>
<a class="sourceLine" id="cb11-6" title="6">pval.pt &lt;-<span class="st"> </span>gaugedSites<span class="op">$</span>trend_pt <span class="co">## Pettitt</span></a>
<a class="sourceLine" id="cb11-7" title="7">cond.trend &lt;-<span class="st"> </span>pval.mk <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.05</span> <span class="op">&amp;</span><span class="st"> </span>pval.pt <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb11-8" title="8">mysites &lt;-<span class="st"> </span>gaugedSites[cond_supreg <span class="op">&amp;</span><span class="st"> </span>cond.trend,<span class="st">&#39;station&#39;</span>]</a>
<a class="sourceLine" id="cb11-9" title="9"></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="kw">addmargins</span>(<span class="kw">table</span>(cond_supreg, cond.trend))</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">##            cond.trend</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">## cond_supreg FALSE TRUE  Sum</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">##       FALSE    36  971 1007</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">##       TRUE      7  100  107</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">##       Sum      43 1071 1114</span></a></code></pre></div>
<p>First, hydrometric data for the pooling group must be prepared in the form of a dataset. As shown earlier, this information can be extracted by passing to the function <code>AmaxData</code> all stations in the super regions. Optionally, a target can be supplied to return only the stations that are part of the pooling group of a given target. The user can also provide a custom measure of similarity in the form of a vector or a distance matrix.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">season.dist &lt;-<span class="st"> </span><span class="kw">SeasonDistanceData</span>(mysites, db)</a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3">xd &lt;-<span class="st"> </span><span class="kw">AmaxData</span>(mysites, db, <span class="dt">target =</span> mystation, <span class="dt">size =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb12-4" title="4">                             <span class="dt">distance =</span> season.dist)</a></code></pre></div>
<p>The RFA analysis of a target site can be performed using the function <code>FloodnetPool</code>that is built upon the function <code>FitRegLmom</code> of the R-package <code>CSHShydRology</code>. The output of the RFA is presented below and the method is briefly explained in the following. It can be noted that RFA appears to have improved the estimation as the standard deviation of the 100-year flood quantile.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">out &lt;-<span class="st"> </span><span class="kw">FloodnetPool</span>(<span class="dt">x =</span> xd, <span class="dt">target =</span> mystation, </a>
<a class="sourceLine" id="cb13-3" title="3">                                 <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">distr =</span> <span class="st">&#39;gev&#39;</span>, <span class="dt">out.model =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">print</span>(out<span class="op">$</span>fit)</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">## Regional frequency analysis with pooling groups</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">## Nb. site: 23</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">## Station-year: 953</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">## Homogeneity: 1.66 -0.71 -0.03</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">## Z-scores (absolute):</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">##  glo  gev  gno  pe3  gpa </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">## 3.44 0.23 0.18 1.27 6.92 </span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co">## Regional L-moments:</span></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co">##    l_1    l_2    LSK   LKUR </span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co">## 1.0000 0.1898 0.1707 0.1465 </span></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co">## Distribution: gev</span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="co">## Parameter:</span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co">##        xi     alpha     kappa </span></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="co">##  0.841778  0.273532 -0.001237</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">print</span>(out<span class="op">$</span>qua)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">##      site    method distribution period variable      value</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">## 1 01AF009 pool_amax          gev    100 quantile  86.140713</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">## 2 01AF009 pool_amax          gev    100     rmse   7.753955</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">## 3 01AF009 pool_amax          gev    100    lower  72.513024</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">## 4 01AF009 pool_amax          gev    100    upper 102.270921</span></a></code></pre></div>
<p>In brief, the function fits an index-flood model (IFM) using the L-moment algorithm. IFM assumes that inside a homogenous region, all distributions are proportional up to a scaling factor. Here this factor is taken as the sample average. One consequence of this hypothesis is that the coefficient of variation must be the same for all sites. The heterogeneous measure <span class="math inline">\(H\)</span> (Hosking and Wallis, 1997) of a pooling group represents the variability of the L-coefficient of variation (LCV), which can be used for judging the veracity of the IFM hypothesis. Also, if not specified, the best distribution among GEV, GLO, GNO and PE3 is selected using the Z-statistic (Hosking and Wallis, 1997) that identify the distribution where the theoretical L-kurtosis best match the theoretical one.</p>
<p>The function <code>FloodnetPool</code> starts with an initial pooling group of size 25. If <span class="math inline">\(H &gt; 2\)</span> the pooling group is considered heterogeneous and should be updated. In turn, each neighboring site is removed and <span class="math inline">\(H\)</span> is re-evaluated. The station leading to the largest improvement in <span class="math inline">\(H\)</span> is removed and the process is repeated until <span class="math inline">\(H \leq 2\)</span>. A stopping criterion is used to ensure that at least 5T station-years are found in the pooling group where T is the return period (Robinson and Reed, 1999). Please note that the function <code>FloodnetPool</code> uses the largest return period requested to evaluate the stopping criterion. For example, to evaluate a 100-year return period, at least 500 station-years are necessary. A warning is issued if it fails to encounter a pooling group where <span class="math inline">\(H \geq 2\)</span>.</p>
<p>The standard deviation and the confidence intervals of the flood quantile are estimated using parametric bootstraps. The simulations are obtained from a multivariate normal distribution and the marginal distributions are adjusted according to the at-site distribution. The correlation coefficients of the normal distribution represent the average value of all pairs of sites.</p>
<p>An alternative to the L-moments algorithm for fitting an RFA model is to optimize the independent likelihood of the model, <em>i.e.</em> the likelihood of the RFA model assuming that all observations are independent. This fitting can be done using the function <code>FloodnetPoolMle</code> that works like <code>FloodnetPool</code>, but that is using the underlying function <code>FitPoolMle</code> of the R-package <code>CSHShydRology</code>.<br />
One difference in the call of this function is the argument <code>type</code> that specified the type of the regional model. The IFM model can be specified using <code>type = &#39;mean&#39;</code>, which will imply that all sites are standardized by the empirical mean and the parameters of the regional distribution are estimated using the likelihood technique.<br />
A similar model is specified by <code>type = &#39;cv&#39;</code>, which assumed that all sites share the same distribution with a common shape parameter. For each site, the model estimates a different location parameter and the scale parameter is proportional to the location parameter up to a regional parameter that plays a similar role to a coefficient of variation. A third model resulting from choosing <code>type = &#39;shape&#39;</code>, assumes that all sites have a common shape parameter with different location and scale parameters for each site.</p>
<p>Other differences with <code>FloodnetPoolMle</code> are that the pooling group is not updated according to its homogeneity and the best distribution is selected as the one having the highest independent likelihood. The example below fit the RFA-AMAX model using the likelihood approach, which takes some time due to the demanding bootstrap procedure.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">FloodnetPoolMle</span>(<span class="dt">x =</span> xd, <span class="dt">target =</span> mystation, <span class="dt">period =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb15-3" title="3">                                <span class="dt">type =</span> <span class="st">&#39;mean&#39;</span>, <span class="dt">nsim =</span> <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">## [Bootstrapping flood quantiles]</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">## ===========================================================================</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">##      site         method distribution period variable      value</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">## 1 01AF009 pool_amax_mean          gev    100 quantile  87.164193</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">## 2 01AF009 pool_amax_mean          gev    100    qmean  86.614748</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">## 3 01AF009 pool_amax_mean          gev    100     qmed  86.322000</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">## 4 01AF009 pool_amax_mean          gev    100       se   7.362708</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">## 5 01AF009 pool_amax_mean          gev    100     rmse   7.375835</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">## 6 01AF009 pool_amax_mean          gev    100    lower  74.347705</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">## 7 01AF009 pool_amax_mean          gev    100    upper 103.074704</span></a>
<a class="sourceLine" id="cb15-15" title="15"></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="kw">FloodnetPoolMle</span>(<span class="dt">x =</span> xd, <span class="dt">target =</span> mystation, <span class="dt">period =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb15-17" title="17">                                <span class="dt">type =</span> <span class="st">&#39;cv&#39;</span>, <span class="dt">nsim =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">##         site       method distribution period variable    value</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">## 0.99 01AF009 pool_amax_cv          gev    100 quantile 88.98795</span></a>
<a class="sourceLine" id="cb15-20" title="20"></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="kw">FloodnetPoolMle</span>(<span class="dt">x =</span> xd, <span class="dt">target =</span> mystation, <span class="dt">period =</span> <span class="dv">100</span>, </a>
<a class="sourceLine" id="cb15-22" title="22">                                <span class="dt">type =</span> <span class="st">&#39;shape&#39;</span>, <span class="dt">nsim =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">##         site          method distribution period variable    value</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">## 0.99 01AF009 pool_amax_shape          gno    100 quantile 80.29852</span></a></code></pre></div>
</div>
<div id="regional-frequency-analysis-using-pot" class="section level2">
<h2>Regional frequency analysis using POT</h2>
<p>The function <code>FloodnetPool</code> can also be used to carry out RFA using POT. Similarly, the information in <code>gaugedSites</code> about trend tests and super regions can be used to select an initial set of stations. In this case, the Mann-Kendall test for the exceedances (column <code>trend_mx</code>) and logistic regression model (column <code>trend_lg</code>) that looks respectively at potential trends in the mean excess and the exceedance probability can be used to remove nonstationary stations. Below we observed that 96 stations of the super regions respect these criteria.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co">## Filter nonstationary sites from the super region of the target</span></a>
<a class="sourceLine" id="cb16-2" title="2">pval.mx &lt;-<span class="st"> </span>gaugedSites<span class="op">$</span>trend_mx <span class="co">## Mann-Kendall</span></a>
<a class="sourceLine" id="cb16-3" title="3">pval.lg &lt;-<span class="st"> </span>gaugedSites<span class="op">$</span>trend_lg <span class="co">## logistic regression</span></a>
<a class="sourceLine" id="cb16-4" title="4">cond.trend &lt;-<span class="st"> </span>pval.lg <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.05</span> <span class="op">&amp;</span><span class="st"> </span>pval.mx <span class="op">&gt;=</span><span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6">info &lt;-<span class="st"> </span>gaugedSites[cond_supreg <span class="op">&amp;</span><span class="st"> </span>cond.trend, <span class="kw">c</span>(<span class="st">&#39;station&#39;</span>,<span class="st">&#39;auto&#39;</span>,<span class="st">&#39;area&#39;</span>)]</a>
<a class="sourceLine" id="cb16-7" title="7"></a>
<a class="sourceLine" id="cb16-8" title="8">season.dist &lt;-<span class="st"> </span><span class="kw">SeasonDistanceData</span>(info<span class="op">$</span>station, db)</a>
<a class="sourceLine" id="cb16-9" title="9"></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="kw">head</span>(info,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">##   station auto      area</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">## 2 01AD003 63.9 1358.6435</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">## 3 01AE001 64.9 2245.7638</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">## 4 01AF007 38.4  328.4387</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">addmargins</span>(<span class="kw">table</span>(cond_supreg, cond.trend))</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">##            cond.trend</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">## cond_supreg FALSE TRUE  Sum</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">##       FALSE   137  870 1007</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">##       TRUE     11   96  107</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">##       Sum     148  966 1114</span></a></code></pre></div>
<p>For performing RFA using POT the input data must be an object of the class <code>peaksdata</code>. The easiest way to do so is to use the function <code>DailyPeaksData</code> that directly the data from HYDAT in the right format. A target can also be specified to limit the output to a specific pooling group. If the peaks were obtained from another source, the right input can be obtained by passing the peaks to the function <code>PeaksData</code> along with the required information, <em>i.e.</em> the threshold used and the total number of years.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">xd &lt;-<span class="st"> </span><span class="kw">DailyPeaksData</span>(info, db, <span class="dt">target =</span> <span class="st">&#39;01AF009&#39;</span>, </a>
<a class="sourceLine" id="cb18-2" title="2">                                         <span class="dt">size =</span> <span class="dv">25</span>, <span class="dt">distance =</span> season.dist)</a></code></pre></div>
<p>The code below fits the POT-IFM model and return the flood quantiles. In this case, regionalization has reduced the variability of the 100-year flood quantiles in comparison with the at-site POT model.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">out &lt;-<span class="st"> </span><span class="kw">FloodnetPool</span>(xd, <span class="dt">target =</span> mystation, <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb19-3" title="3">                         <span class="dt">out.model =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">## [Updating pooling group]</span></a>
<a class="sourceLine" id="cb19-6" title="6"></a>
<a class="sourceLine" id="cb19-7" title="7">out<span class="op">$</span>qua</a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">##      site   method distribution period variable     value</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co">## 1 01AF009 pool_pot          gpa    100 quantile 83.541574</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">## 2 01AF009 pool_pot          gpa    100     rmse  7.625154</span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">## 3 01AF009 pool_pot          gpa    100    lower 69.675682</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">## 4 01AF009 pool_pot          gpa    100    upper 99.614365</span></a></code></pre></div>
<p>In the previous example, the intersite correlation was not considered in the estimation of the flood quantiles, which may lead to underestimating the variability of the estimated flood quantiles. It should be noted that if peaks are passed in <code>FloodnetPool</code> as a data.frame, they will be treated as AMAX data. Therefore, one could obtain flood quantile estimates by selecting the GPA and impose a desired intersite correlation structure. Note that the return period will need to be multiplied by the target PPY to obtain the proper exceeding probability and a 3 parameter GPA is used. The example below shows the standard deviation obtained using that approach with a correlation coefficient of 0.5.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">ppy &lt;-<span class="st"> </span><span class="kw">with</span>(xd, npeak[<span class="dv">1</span>]<span class="op">/</span>nyear[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb20-2" title="2">xp &lt;-<span class="st"> </span>xd<span class="op">$</span>peaks</a>
<a class="sourceLine" id="cb20-3" title="3"></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb20-5" title="5">out &lt;-<span class="st"> </span><span class="kw">FloodnetPool</span>(xp, <span class="dt">target =</span> mystation, <span class="dt">distr =</span> <span class="st">&#39;gpa&#39;</span>, <span class="dt">tol.H =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb20-6" title="6">                                        <span class="dt">period =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>ppy, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">corr =</span> <span class="fl">.5</span>)</a></code></pre></div>
<p>Another way of fitting the POT model is to use the likelihood approach. The results below were obtained by passing the argument <code>type = &#39;shape&#39;</code> which specifies GPA distributions where site-specific scale parameters are used with a common shape parameter.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">FloodnetPoolMle</span>(xd, <span class="dt">target =</span> mystation, <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">nsim =</span> <span class="dv">500</span>, <span class="dt">type =</span> <span class="st">&#39;shape&#39;</span>)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">## </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">## [Bootstrapping flood quantiles]</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">## ===========================================================================</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">##      site         method distribution period variable      value</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">## 1 01AF009 pool_pot_shape          gpa    100 quantile  86.907541</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="co">## 2 01AF009 pool_pot_shape          gpa    100    qmean  83.733842</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co">## 3 01AF009 pool_pot_shape          gpa    100     qmed  83.411905</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="co">## 4 01AF009 pool_pot_shape          gpa    100       se   7.932458</span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="co">## 5 01AF009 pool_pot_shape          gpa    100     rmse   8.536417</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="co">## 6 01AF009 pool_pot_shape          gpa    100    lower  69.486779</span></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="co">## 7 01AF009 pool_pot_shape          gpa    100    upper 100.021589</span></a></code></pre></div>
</div>
<div id="prediction-at-ungauged-basins" class="section level2">
<h2>Prediction at ungauged basins</h2>
<p>When there is no hydrometric data at the site of interest, frequency analysis cannot be done by fitting directly a distribution of extreme events. The quantile regression techniques (QRT) is a method that is used in this situation to predict flood quantiles based on the characteristics of the site of interest. First, it evaluates the flood quantiles of gauged stations using at-site information. Next, a regression model is used to predict the flood quantile at a site of interest (ungauged) based on its descriptors.</p>
<p>Similar to the dataset <code>gaugedSites</code>, this package includes a dataset <code>descriptors</code> that contains meteorological and physical characteristics for 770 stations that are also in <code>gaugedSites</code>. This information can be used to fit a QRT model that predicts flood quantiles at sites of interest. In the example below, we create a dataset including 6 descriptors: Drainage area (AREA), mean annual precipitation (MAP), percentage of waterbodies (WB), stream density (STREAM), elevation (ELEV) and slope (SLOPE).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">xd &lt;-<span class="st"> </span><span class="kw">with</span>(descriptors,</a>
<a class="sourceLine" id="cb22-2" title="2">  <span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb22-3" title="3">    <span class="dt">site =</span> station,</a>
<a class="sourceLine" id="cb22-4" title="4">    <span class="dt">area =</span> <span class="kw">log</span>(area),</a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="dt">map  =</span> <span class="kw">log</span>(map_ws),</a>
<a class="sourceLine" id="cb22-6" title="6">    <span class="dt">wb   =</span> <span class="kw">log</span>(.<span class="dv">01</span> <span class="op">+</span><span class="st"> </span>wb),</a>
<a class="sourceLine" id="cb22-7" title="7">    <span class="dt">stream =</span> <span class="kw">log</span>(.<span class="dv">01</span> <span class="op">+</span><span class="st"> </span>stream),</a>
<a class="sourceLine" id="cb22-8" title="8">    <span class="dt">elev =</span> elev_ws,</a>
<a class="sourceLine" id="cb22-9" title="9">    <span class="dt">slope =</span> <span class="kw">log</span>(.<span class="dv">01</span> <span class="op">+</span><span class="st"> </span>slope)))</a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11">coord &lt;-<span class="st"> </span>descriptors[, <span class="kw">c</span>(<span class="st">&#39;lon&#39;</span>, <span class="st">&#39;lat&#39;</span>)]</a></code></pre></div>
<p>Logarithmic transformations are used above for most variables to make the input variables more normally shaped. In addition, multidimensional scaling is used here to project the geographical coordinates in a Cartesian space that aims to preserve the great-circle distance.</p>
<p>In this section, the station <code>01AF009</code> is treated as ungauged and the objective is to evaluate the 100-year flood quantile (Q100) according to its descriptors. Remember that we derived a Q100 of 98.0 <span class="math inline">\(m^3/s\)</span> from an at-site flood frequency analysis of the annual maxima.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">target.id &lt;-<span class="st"> </span>(xd<span class="op">$</span>site <span class="op">==</span><span class="st"> &#39;01AF009&#39;</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"></a>
<a class="sourceLine" id="cb23-3" title="3">target &lt;-<span class="st"> </span>xd[target.id,]</a>
<a class="sourceLine" id="cb23-4" title="4">xd &lt;-<span class="st"> </span>xd[<span class="op">-</span>target.id,]</a></code></pre></div>
<p>The function <code>FloodnetRoi</code> is built upon the function <code>FitRoi</code> in <code>CSHShydRology</code> and performs flood frequency at ungauged sites using QRT. First, it extracts the annual maxima of HYDAT and evaluates the flood quantiles <span class="math inline">\(q_i\)</span> of each gauged station (<span class="math inline">\(i\)</span>). Next, a locally log-linear model is applied to the nearest stations to the target <span class="math inline">\(j\)</span>: <span class="math display">\[
\log(q_j) = \mathbf{X}_j\beta_j + e_j
\]</span> where <span class="math inline">\(\mathbf{X}_j\)</span> is a design matrix of descriptors, <span class="math inline">\(\beta_j\)</span> is local parameters and <span class="math inline">\(e_j\)</span> is a term of error. The distance between sites is taken as the Euclidean distance between standardized descriptors. Also, weights proportional to the Epanechnikov kernel are used to give more importance to more similar sites. Please note that the support of the Epanechnikov kernel is bounded and hence the bandwidth parameter that controls the relative importance of the nearest sites is expressed in terms of the number of gauged stations inside these bounds, which corresponds to the size of the region of influence (<code>size</code>). If more than one size is provided, <code>FloodnetRoi</code> uses 10-fold cross-validation to find the parameter that optimizes the Mean Absolute Deviation (MAD). The results of the cross-validation scheme can be obtained by passing the argument <code>out.model = TRUE</code>. The figure below shows that sizes between 60 and 90 stations are optimal.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">out &lt;-<span class="st"> </span><span class="kw">FloodnetRoi</span>(<span class="dt">target =</span> target, <span class="dt">sites =</span> xd,</a>
<a class="sourceLine" id="cb24-3" title="3">                        <span class="dt">db =</span> db, <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">size =</span> <span class="kw">seq</span>(<span class="dv">25</span>, <span class="dv">200</span>, <span class="dv">10</span>), </a>
<a class="sourceLine" id="cb24-4" title="4">                        <span class="dt">nsim =</span> <span class="dv">0</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">out.model =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The function <code>FloodnetRoi</code> uses a bootstrap technique to evaluate the uncertainty of the estimated flood quantiles. As done previously for the RFA using gauged sites, annual maxima are simulated using a multivariate normal distribution with marginal transformed to the respective at-site distributions. This leads to a bootstrap sample of flood quantiles <span class="math inline">\(q_i^\ast\)</span> at each gauged site <span class="math inline">\(i\)</span>. In parallel, prediction errors <span class="math inline">\(e^\ast_i\)</span> are sampled (balance bootstrap) from the residuals of the QRT model based on 10-fold cross-validation. The final bootstrap sample is composed of the flood quantiles values <span class="math inline">\(\q_i^{\ast\ast} = \q_i^\ast+e^\ast_i\)</span> that account for the modeling error of the QRT model and the sampling error due to the at-site estimation of the flood quantiles.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">FloodnetRoi</span>(<span class="dt">target =</span> target, <span class="dt">sites =</span> xd, <span class="dt">db =</span> db, </a>
<a class="sourceLine" id="cb25-3" title="3">                        <span class="dt">period =</span> <span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">85</span>, <span class="dt">nsim =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">## [Bootstrapping]</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co">## ===========================================================================</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">##      site method period variable     value</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co">## 1 01AF009    QRT    100 quantile 108.07209</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co">## 2 01AF009    QRT    100       se  16.28591</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">## 3 01AF009    QRT    100    lower  79.37518</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="co">## 4 01AF009    QRT    100    upper 135.06903</span></a></code></pre></div>
<p>Moreover, the set of existing site characteristics does not fully characterize the relationship between the descriptors and the flood quantiles. In particular, several potentially missing descriptors could be spatially distributed, which would lead to spatially correlated residuals. If coordinates are provided to the function <code>FloodnetRoi</code>, it will further perform a simple kriging technique on the residual of the QRT to improve the prediction of the flood quantiles when there is spatial correlation among them. The example below shows that the criterion MAD improves from 38.0 to 34.0 when the kriging step is added to the QRT model.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co">## Extract the coordinates</span></a>
<a class="sourceLine" id="cb26-2" title="2">coord &lt;-<span class="st"> </span>descriptors[, <span class="kw">c</span>(<span class="st">&#39;lon&#39;</span>, <span class="st">&#39;lat&#39;</span>)]</a>
<a class="sourceLine" id="cb26-3" title="3">coord &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cmdscale</span>(<span class="kw">GeoDist</span>(coord), <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb26-4" title="4"></a>
<a class="sourceLine" id="cb26-5" title="5">target.coord &lt;-<span class="st"> </span>coord[target.id,]</a>
<a class="sourceLine" id="cb26-6" title="6">coord &lt;-<span class="st"> </span>coord[<span class="op">-</span>target.id,]</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-2" title="2">out &lt;-<span class="st"> </span><span class="kw">FloodnetRoi</span>(<span class="dt">target =</span> target, <span class="dt">sites =</span> xd,</a>
<a class="sourceLine" id="cb27-3" title="3">                        <span class="dt">target.coord =</span> target.coord, <span class="dt">sites.coord =</span> coord,</a>
<a class="sourceLine" id="cb27-4" title="4">                        <span class="dt">size =</span> <span class="dv">209</span><span class="op">:</span><span class="dv">211</span>, <span class="dt">db =</span> db, <span class="dt">period =</span> <span class="dv">100</span>, </a>
<a class="sourceLine" id="cb27-5" title="5">                        <span class="dt">nsim =</span> <span class="dv">0</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">out.model =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-6" title="6"></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="kw">head</span>(out<span class="op">$</span>cv)</a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">## </span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co">## Cross-validation for Region of Influence (ROI)</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="co">## Best 3 sizes of neighborhood</span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="co">##    nk      rmse     rrmse       nsh       mad       rmad      smad</span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="co">## 2 210 0.4538652 0.2612458 0.9260712 0.3392777 0.09981507 0.7465667</span></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="co">## 3 211 0.4538959 0.2612461 0.9260612 0.3393004 0.09981806 0.7465497</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="co">## 1 209 0.4538397 0.2613160 0.9260795 0.3393019 0.09982216 0.7465486</span></a></code></pre></div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>In summary, this document showed how the R-package <code>floodnetProject16</code> can be used to perform flood frequency analysis using the hydrometric data found in the HYDAT database. The function <code>FloodnetAmax</code> and <code>FloodnetPot</code> were shown to carry out at-site frequency analysis based on annual maximum and peaks over threshold. The functions <code>FloodnetPool</code> and <code>FloodnetPoolMle</code> were used to obtain flood quantiles from regional analysis based on either AMAX and POT. Finally, it was shown how evaluation of flood quantiles at ungauged sites can be performed using the function <code>FloodnetRoi</code>.</p>
<p>Two datasets : <code>gaugedSites</code>, <code>descriptors</code> were presented that contain useful information derived from HYDAT. In particular, they suggest candidate thresholds for POT analysis, super regions for delineating pooling groups, trend tests to identify stationary stations and site descriptors to predict hydrological variables at ungauged sites. Some of this information will become outdated, but represent a good starting point. Please see the extra materials that contain more codes examples.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><p>Durocher, M., Burn, D. H., &amp; Mostofi Zadeh, S. (2018). A nationwide regional flood frequency analysis at ungauged sites using ROI/GLS with copulas and super regions. Journal of Hydrology, 567, 191–202. <a href="https://doi.org/10.1016/j.jhydrol.2018.10.011" class="uri">https://doi.org/10.1016/j.jhydrol.2018.10.011</a></p></li>
<li><p>Durocher, M., Zadeh, S. M., Burn, D. H., &amp; Ashkar, F. (2018). Comparison of automatic procedures for selecting flood peaks over threshold based on goodness-of-fit tests. Hydrological Processes. <a href="https://doi.org/10.1002/hyp.13223" class="uri">https://doi.org/10.1002/hyp.13223</a></p></li>
<li><p>Durocher, M., Burn, D. H., Zadeh, S. M., &amp; Ashkar, F. (2019). Estimating flood quantiles at ungauged sites using nonparametric regression methods with spatial components. Hydrological Sciences Journal, 64(9), 1056–1070. <a href="https://doi.org/10.1080/02626667.2019.1620952" class="uri">https://doi.org/10.1080/02626667.2019.1620952</a></p></li>
<li><p>Helsel, D. R., &amp; Hirsch, R. M. (2002). Statistical Methods in Water Resources. In Techniques of Water-Resources Investigations of the United States Geological Survey. Retrieved from <a href="http://water.usgs.gov/pubs/twri/twri4a3/" class="uri">http://water.usgs.gov/pubs/twri/twri4a3/</a></p></li>
<li><p>Lang, M., Ouarda, T. B. M. J., &amp; Bobée, B. (1999). Towards operational guidelines for over-threshold modeling. Journal of Hydrology, 225(3), 103–117. <a href="https://doi.org/10.1016/S0022-1694(99)00167-5" class="uri">https://doi.org/10.1016/S0022-1694(99)00167-5</a></p></li>
<li><p>Mostofi Zadeh, S., &amp; Burn, D. H. (2019). A Super Region Approach to Improve Pooled Flood Frequency Analysis. Canadian Water Resources Journal / Revue Canadienne Des Ressources Hydriques, 0(0), 1–14. <a href="https://doi.org/10.1080/07011784.2018.1548946" class="uri">https://doi.org/10.1080/07011784.2018.1548946</a></p></li>
<li><p>Robson, A., &amp; Reed, D. (1999). Flood estimation handbook. Institute of Hydrology, Wallingford.</p></li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
